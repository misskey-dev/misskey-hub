import{_ as n,o as i,c as s,a,b as d,w as r,d as t,e as u,r as l}from"./app.288dd8b3.js";const m={},k=a("h1",{id:"misskey-install-shell-script-v3-0-0",tabindex:"-1"},[a("a",{class:"header-anchor",href:"#misskey-install-shell-script-v3-0-0","aria-hidden":"true"},"#"),t(" Misskey install shell script v3.0.0")],-1),o=a("p",null,"Pasang Misskey dengan satu shell script!",-1),p=a("p",null,"Kamu dapat memasang misskey pada peladen Ubuntu hanya dengan menjawab beberapa pertanyaan saja.",-1),h=a("p",null,"Terdapat juga script untuk memutakhirkan.",-1),c=a("a",{href:"https://github.com/joinmisskey/bash-install/blob/a096e874f93d493aa68975a31be9ce12d644e767/README.en.md",target:"_blank",rel:"noopener noreferrer"},"Untuk v12",-1),g=a("br",null,null,-1),b=a("strong",null,"\u65E5\u672C\u8A9E\u7248\u306F\u3053\u3061\u3089",-1),v=u(`<h2 id="lisensi" tabindex="-1"><a class="header-anchor" href="#lisensi" aria-hidden="true">#</a> Lisensi</h2><p><a href="./LICENSE">Lisensi MIT</a></p><h2 id="bahan" tabindex="-1"><a class="header-anchor" href="#bahan" aria-hidden="true">#</a> Bahan</h2><ol><li>Domain</li><li>Peladen Ubuntu</li><li>Akun Cloudflare (Direkomendasikan)</li></ol><div class="custom-container danger"><i class="fas fa-times"></i><p>Jangan pernah mengganti nama domain (hostname) peladen ketika kamu sudah mulai menggunakannya!</p></div><h2 id="pengaturan-clouflare" tabindex="-1"><a class="header-anchor" href="#pengaturan-clouflare" aria-hidden="true">#</a> Pengaturan Clouflare</h2><p>Jika kamu menggunakan nginx dan Cloudflare, kamu harus mengatur Cloudflare terlebih dahulu untuk:</p><ul><li>Mengatur DNS.</li><li>Pada tab pengaturan SSL/TLS, ubah mode enkripsi ke &quot;Full&quot;.</li></ul><h2 id="prosedur" tabindex="-1"><a class="header-anchor" href="#prosedur" aria-hidden="true">#</a> Prosedur</h2><h3 id="_1-ssh" tabindex="-1"><a class="header-anchor" href="#_1-ssh" aria-hidden="true">#</a> 1. SSH</h3><p>Menyambung ke peladen melalui SSH.<br> (Jika kamu memiliki peladen dengan lingkungan desktop terpasang, buka Terminal/shell)</p><h3 id="_2-pembersihan" tabindex="-1"><a class="header-anchor" href="#_2-pembersihan" aria-hidden="true">#</a> 2. Pembersihan</h3><p>Pastikan semua paket telah termutakhirkan dan boot ulang.</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>sudo apt update; sudo apt full-upgrade -y; sudo reboot
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_3-jalankan-pemasangan" tabindex="-1"><a class="header-anchor" href="#_3-jalankan-pemasangan" aria-hidden="true">#</a> 3. Jalankan pemasangan</h3><p>Hubungkan ulang SSH dan mulai pemasangan Misskey.</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>wget https://raw.githubusercontent.com/joinmisskey/bash-install/main/ubuntu.sh -O ubuntu.sh; sudo bash ubuntu.sh
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_4-untuk-memutakhirkan" tabindex="-1"><a class="header-anchor" href="#_4-untuk-memutakhirkan" aria-hidden="true">#</a> 4. Untuk memutakhirkan</h3><p>Terdapat juga script untuk memutakhirkan peladen Misskey.</p><p>Script pemutakhirant tidak memutakhirkan lingkungan peladen.<br> Mohon untuk merujuk ke CHANGELOG (Bahasa Jepang) dan <a href="https://github.com/joinmisskey/bash-install/releases" target="_blank" rel="noopener noreferrer">Daftar rilis di GitHub (Bahasa Inggris)</a> serta lakukan operasi migrasi sesuai arahan.</p><p>Pertama, unduh script.</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>wget https://raw.githubusercontent.com/joinmisskey/bash-install/main/update.ubuntu.sh -O update.sh
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Jalankan ini ketika kamu ingin memutakhirkan Misskey.</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>sudo bash update.sh
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>Pada lingkungan systemd, opsi <code>-r</code> dapat digunakan untuk memutakhirkan dan memboot ulang sistem.</li><li>Pada lingkungan docker, kamu dapat menentukan repository:tag sebagai argumen.</li></ul><h2 id="lingkungan-dimana-operasi-ini-telah-diuji" tabindex="-1"><a class="header-anchor" href="#lingkungan-dimana-operasi-ini-telah-diuji" aria-hidden="true">#</a> Lingkungan dimana operasi ini telah diuji</h2><h3 id="oracle-cloud-infrastructure" tabindex="-1"><a class="header-anchor" href="#oracle-cloud-infrastructure" aria-hidden="true">#</a> Oracle Cloud Infrastructure</h3><p>Script ini bekerja dengan baik pada bentuk compute berikut yang disediakan oleh Oracle Cloud Infrastructure Always Free services.</p><ul><li>VM.Standard.E2.1.Micro (AMD)</li><li>VM.Standard.A1.Flex (ARM) [1OCPU RAM6GB or greater]</li></ul><p>Jawab untuk menggunakan iptables.</p><h2 id="isu-prs-dipersilahkan" tabindex="-1"><a class="header-anchor" href="#isu-prs-dipersilahkan" aria-hidden="true">#</a> Isu &amp; PRs Dipersilahkan</h2><p>Apabila script ini tidak dapat bekerja pada lingkungan diatas, kemungkinan karena bug. Kami mengapresiasi apabila kamu dapat melaporkan hal tersebut sebagai isu dengan syarat tertentu yang telah kamu input ke dalam script.</p><p>Sangat sulit untuk memberikan bantuan untuk lingkungan selain yang disebutkan di atas, namun kami masih dapat membantu mencarikan solusi dari masalah kamu apabila kamu memberikan informasi detil mengenai lingkungan peladenmu.</p><p>Saran untuk fitur juga dipersilahkan.</p><h1 id="tips" tabindex="-1"><a class="header-anchor" href="#tips" aria-hidden="true">#</a> Tips</h1><p>Cara memilih opsi dan spesifikasi.</p><h2 id="systemd-or-docker" tabindex="-1"><a class="header-anchor" href="#systemd-or-docker" aria-hidden="true">#</a> Systemd or Docker?</h2><p>Mulai dari v1, terdapat metode pemasangan systemd atau Docker yang dapat dipilih.</p><p>Ketika memilih metode pemasangan Docker, Misskey akan dipasang dan dijalankan melalui Docker sedangkan Redis, Postgres dan sebagainya akan dipasang dan dijalankan pada host peladen langsung.</p><p>Apabila kamu memilih menggunakan image dari Docker Hub, kebutuhan untuk build Misskey tidak diperlukan dan pilihan ini merupakan rekomendasi dari kami. Namun ketika melakukan pemutakhiran, migrasi tetap dibutuhkan dan downtime tetap tidak dapat terhindarkan. Selain itu, dengan menggunakan image dari Docker Hub tidak perlu lagi menyiapkan lingkungan untuk build Misskey (tidak ada <code>git pull</code>). Dengan kata lain, apabila ingin menyiapkan dan menjalankan fork akan lebih merepotkan.</p><p>Karena alasan performa, metode build Docker secara lokal tidak dipergunakan lagi.</p><p>Metode pemasangan systemd sangat direkomendasikan apabila kamu ingin menggunakan ataupun menjalankan fork. Metode pemasangan ini juga tidak mengharuskan kamu untuk mengunggah image ke Docker Hub.</p><p>Urutan rekomendasi yang disarankan adalah sebagai berikut:</p><ol><li>Docker Hub</li><li>systemd</li><li>Docker Build</li></ol><h2 id="gunakan-nginx-atau-tidak" tabindex="-1"><a class="header-anchor" href="#gunakan-nginx-atau-tidak" aria-hidden="true">#</a> Gunakan nginx atau tidak?</h2><p>Apabila kamu ingin membuat peladen Misskey pada satu peladen, disarankan untuk menggunakan nginx.</p><h2 id="tambahkan-swap" tabindex="-1"><a class="header-anchor" href="#tambahkan-swap" aria-hidden="true">#</a> Tambahkan swap!</h2><p>Apabila kamu menggunakan swap, pastikan swap kamu memiliki hingga ruang hingga 3GB. Karena script akan dapat berjalan lancar apabila memiliki memori dengan minimal 3GB.</p><h2 id="jika-script-gagal-dan-kamu-ingin-menjalankannya-kembali" tabindex="-1"><a class="header-anchor" href="#jika-script-gagal-dan-kamu-ingin-menjalankannya-kembali" aria-hidden="true">#</a> Jika script gagal dan kamu ingin menjalankannya kembali</h2><p>Perhatikan arahan berikut ini:</p><ul><li>Apabila Redis atau Postgres telah terpasang, atur <code>install locally</code> ke &quot;No&quot;. Biarkan pengaturan <code>host\u30FBport</code> apa adanya lalu tekan Enter. Masukkan nama pengguna dan kata sandi seperti yang telah ditentukan pada proses sebelumnya.</li></ul><h2 id="mengenai-berkas-env" tabindex="-1"><a class="header-anchor" href="#mengenai-berkas-env" aria-hidden="true">#</a> Mengenai berkas .env</h2><p>Script pemasangan membuat dua berkas .env yang dipergunakan untuk memutakhirkan Misskey.</p><h3 id="root-misskey-env" tabindex="-1"><a class="header-anchor" href="#root-misskey-env" aria-hidden="true">#</a> /root/.misskey.env</h3><p>Diperlukan untuk mengingat pengguna yang menjalankan proses misskey</p><h3 id="home-pengguna-misskey-misskey-env" tabindex="-1"><a class="header-anchor" href="#home-pengguna-misskey-misskey-env" aria-hidden="true">#</a> /home/(pengguna_misskey)/.misskey.env</h3><p>Dibuat untuk systemd yang dipertujukan mengingat direktori.</p><h3 id="home-pengguna-misskey-misskey-docker-env" tabindex="-1"><a class="header-anchor" href="#home-pengguna-misskey-misskey-docker-env" aria-hidden="true">#</a> /home/(pengguna_misskey)/.misskey-docker.env</h3><p>Dibuat untuk Docker dengan tujuan menyimpan nomor kontainer beserta image yang sedang berjalan. Nomor kontainer akan diperbarui selama pemutakhiran. Image lama akan dihapus.</p><h2 id="manajemen-mandiri" tabindex="-1"><a class="header-anchor" href="#manajemen-mandiri" aria-hidden="true">#</a> Manajemen Mandiri</h2><p>Setelah pemasangan, ada beberapa catatan yang cukup berguna pada saat ingin mengubah konfigurasi.</p><p>Ganti domain &quot;example.com&quot; dengan domain kamu sendiri.</p><h3 id="direktori-misskey" tabindex="-1"><a class="header-anchor" href="#direktori-misskey" aria-hidden="true">#</a> Direktori Misskey</h3><p>Sumber kode akan diklon pada dikrektori <code>/home/pengguna/direktori</code>. (nilai default untuk pengguna dan direktori adalah <code>misskey</code>)</p><p>Kamu dapat menavigasi ke direktori Misskey dengan melakukan perintah berikut.</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>sudo -iu pengguna
cd direktori
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>Untuk kembali ke pengguna sebelumnya, jalankan perintah <code>exit</code>.</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>exit
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="systemd" tabindex="-1"><a class="header-anchor" href="#systemd" aria-hidden="true">#</a> systemd</h3><p>Nama proses dalam systemd adalah <code>example.com</code>.<br> Sebagai contoh untuk memulai ulang proses, jalankan perintah berikut.</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>sudo systemctl restart example.com
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Kamu dapat memeriksa logs dengan menggunakan <code>journalctl</code>.</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>journalctl -t example.com
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Berkas konfigurasi systemd disimpan pada <code>/etc/systemd/system/example.com.service</code>.</p><h3 id="docker" tabindex="-1"><a class="header-anchor" href="#docker" aria-hidden="true">#</a> Docker</h3><p>Docker menggunakan pengguna Misskey untuk dijalankan secara tanpa root.</p><p>Saat masuk ke pengguna Misskey menggunakan sudo, kamu perlu mengubah <code>XDG_RUNTIME_DIR</code> dan <code>DOCKER_HOST</code> terlebih dahulu.</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>sudo -iu pengguna
export XDG_RUNTIME_DIR=/run/user/$UID
export DOCKER_HOST=unix://$XDG_RUNTIME_DIR/docker.sock

# Tampilkan daftar Proses
docker ps

# Build (Repositori: local/misskey:latest)
docker build -t local/misskey:latest ./misskey

# Menjalankan Docker
docker run -d -p 3000:3000 --add-host=docker_host:10.0.0.1 -v /home/misskey/misskey/files:/misskey/files -v &quot;/home/misskey/misskey/.config/default.yml&quot;:/misskey/.config/default.yml:ro --restart unless-stopped -t &quot;local/misskey:latest&quot;

# Menampilkan log
docker logs --tail 50 -f \u30B3\u30F3\u30C6\u30CAID
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Proses diatas dapat dilakukan dengan perintah satu baris berikut.</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>sudo -u pengguna XDG_RUNTIME_DIR=/run/user/$(id -u pengguna) DOCKER_HOST=unix:///run/user/$(id -u pengguna)/docker.sock docker ps
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="nginx" tabindex="-1"><a class="header-anchor" href="#nginx" aria-hidden="true">#</a> nginx</h3><p>Pengaturan situs pada nginx disimpan di <code>/etc/nginx/conf.d/example.com.conf</code>.</p><h3 id="redis" tabindex="-1"><a class="header-anchor" href="#redis" aria-hidden="true">#</a> Redis</h3><p>Parameter <code>requirepass</code> dan <code>bind</code> diatur di <code>/etc/redis/misskey.conf</code>.</p><h2 id="q-error-502-tidak-dapat-diakses-setelah-melakukan-pemutakhiran" tabindex="-1"><a class="header-anchor" href="#q-error-502-tidak-dapat-diakses-setelah-melakukan-pemutakhiran" aria-hidden="true">#</a> Q. Error 502 tidak dapat diakses setelah melakukan pemutakhiran</h2><p>Apabila proses migrasi sedang berlangsung, Docker tidak dapat memberikan izin akses langsung. Pastikan dan periksa apakah proses migrasi telah selesai.</p><p>Pada kasus menggunankan systemd, perintah <code>pnpm install</code> kemungkinan gagal. Coba jalankan perintah berikut ini di direktori Misskey lalu jalankan pemutakhiran kembali.</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>pnpm run clean-all
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Apabila kamu memeriksa log dengan <code>journalctl</code>, umumnya kamu akan menemukan pernyataan dalam log yang menampilkan <code>re2</code>.</p><h2 id="q-membangun-instansi-misskey-lebih-dari-1-di-peladen-yang-sama" tabindex="-1"><a class="header-anchor" href="#q-membangun-instansi-misskey-lebih-dari-1-di-peladen-yang-sama" aria-hidden="true">#</a> Q. Membangun instansi Misskey lebih dari 1 di peladen yang sama</h2><p>Script ini tidak dapat melakukan pemasangan instansi Misskey lebih dari 1 pada peladen yang sama. Hal ini dikarenakan beberapa pengaturan nantinya akan ditimpa dan kamu akan mendapatkan banyak galat dan kesalahan dalam proses menjalankan script ini.</p>`,91);function y(x,f){const e=l("RouterLink");return i(),s("div",null,[k,o,p,h,a("p",null,[c,g,d(e,{to:"/id/docs/install/"},{default:r(()=>[b]),_:1})]),v])}var j=n(m,[["render",y],["__file","bash.html.vue"]]);export{j as default};
